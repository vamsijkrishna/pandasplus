global:
    encoding: "utf-16"
    seperator: ","
    name: china
    source : "$CHINA_FOLDER/<year>/small-<month>.txt"
    source_vars:
        year:
            start: 2001
            end: 2001
        month:
            start: 1
            end: 1
            zfill: 2
    concat: YES

    output : "/tmp/china/<year>/<month>"

    type:
        quantity : "int"
        amount: "int"

    agg:
        "quantity": "sum"
        "amount": "sum"

    transform:
        "import or export":
            type: "unstack"
            target: "import or export"
        "province and city":
            -
                type: "func"
                func: "plugins.attribute_map.find_zip"
            -
                type: "prepend"
                value: "CN"
        "HS8":
            - 
                type: "slice"
                length: 4
            - 
                type: "DBLOOKUP"
                table: "attrs_hs"
                key: "substr(id, 3)"
                value: "id"
                where: "char_length(id) = 6"


tables:
    ymgp:
        pk: ["year", "province and city", "HS8"]
        depths: { "HS8": [YES], "province and city" : [YES]  }
        rca:
            index: "province and city"
            column: "HS8"
            values: [amount出口, amount进口]
    # ymp:
        # pk: ["year", "month", "HS8"]

